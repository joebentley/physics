\documentclass[11pt]{amsart}
\usepackage{amsmath,amsfonts,amsthm,amssymb, amsaddr}


\title{Coordinate Systems}

\author{Joe Bentley}

\date{\today}

\begin{document}

\maketitle

\newpage

\section{Orthogonal Coordinate Systems}

When we are looking to construct a new coordinate system, we want to be able to translate between unit vectors and coordinates of both coordinate systems. In this section we can explore how we can construct orthogonal coordinate systems, which is, coordinate systems where the basis are always orthogonal.

First, suppose that the Cartesian coordinates $(x, y, z)$ of any point $P$ in space can be expressed as functions of three variables $(u_1, u_2, u_3)$ such that,

\begin{align*}
  \mathbf{r} =
  \begin{pmatrix}
    x \\
    y \\
    z \\
  \end{pmatrix} =
  \begin{pmatrix}
    x(u_1, u_2, u_3) \\
    y(u_1, u_2, u_3) \\
    z(u_1, u_2, u_3)
  \end{pmatrix}
\end{align*}

If each point $P$ corresponds to a \textit{unique} set of new coordinates $(u_1, u_2, u_3)$ then these are called curvilinear coordinates of $P$. That is, for the coordinates $(u_1, u_2, u_3)$ to be curvilinear, they must be the \textit{only} set of new coordinates that corresponds to point $P$.

We know from directional derivatives that $\frac{\partial\mathbf{r}}{\partial u_1}$, $\frac{\partial\mathbf{r}}{\partial u_2}$, $\frac{\partial\mathbf{r}}{\partial u_3}$ are vectors in the directions of increasing $u_1$, $u_2$, and $u_3$ respectively. These may not necessarily be unit vectors, as they might not have a length of unity, so we may write,

\begin{align*}
   \frac{\partial\mathbf{r}}{\partial u_1} = h_1 \mathbf{e_1} \qquad \frac{\partial\mathbf{r}}{\partial u_2} = h_2 \mathbf{e_2} \qquad \frac{\partial\mathbf{r}}{\partial u_3} = h_3 \mathbf{e_3}
\end{align*}

where $\mathbf{e_1}$, $\mathbf{e_2}$, $\mathbf{e_3}$ are unit vectors in the directions of increasing $u_1$, $u_2$, and $u_3$ respectively. The quantities $h_1$, $h_2$, and $h_3$ are \textit{scale factors} which scale the derivative down to unity, such that,

\begin{align*}
  \frac{1}{h_i} \left|\frac{\partial\mathbf{r}}{\partial u_i}\right| = 1
\end{align*}

and therefore we can calculate the scale factor $h_i$ by,

\begin{align*}
  \left|\frac{\partial\mathbf{r}}{\partial u_i}\right| = h_i
\end{align*}




If our unit vectors $\mathbf{e_1}$, $\mathbf{e_2}$, $\mathbf{e_3}$ are mutually orthogonal, then we have an orthogonal coordinate system.

One final point is the order the coordinates are written in. This is mathematically arbitrary, but we want to choose coordinates such that,

\begin{align*}
  \hat{\imath}\times\hat{\jmath}&=\hat{k}
\end{align*}

or in terms of our more general unit vectors,

\begin{align*}
  \mathbf{e_1}\times\mathbf{e_2}&=\mathbf{e_3}
\end{align*}

If the coordinates are our of order, such that for example $\mathbf{e_1}$ and $\mathbf{e_2}$ are switched so that the coordinates are written $(u_2, u_1, u_3)$, then the result of the cross product of the first two unit basis vectors will be negative instead of positive. We would prefer them to be positive as this feels more physically intuitive and natural.

In the next few examples, we will find the unit vectors of various coordinate systems, as well as proving their orthogonality.

\section{Cylindrical Polar Coordinates}

We have enough experience in cylindrical polar coordinates to know how to write the Cartesian coordinates $(x, y, z)$ in terms of the cylindrical coordinates $(\rho, \phi, z)$,

\begin{align*}
  \mathbf{r} =
  \begin{pmatrix}
    x \\
    y \\
    z
  \end{pmatrix} =
  \begin{pmatrix}
    \rho\cos\phi \\
    \rho\sin\phi \\
    z
  \end{pmatrix}
\end{align*}

How do we know to order the coordinates $(\rho, \phi, z)$? We don't, and we will check their order once finding the unit vectors.

First, we want to find the unit basis $\mathbf{e_{\rho}}$. We can do this by taking the derivative of the position vector with respect to the coordinate $\rho$. This will give us a possibly non-unit vector in the direction of changing $\rho$, which we then need to divide by the scale factor $h_{\rho}$ to give us the unit basis vector $\mathbf{e_{\rho}}$.

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial\rho} =
  \begin{pmatrix}
    \cos\phi \\
    \sin\phi \\
    0
  \end{pmatrix}
\end{align*}

We can see here that the result is already a unit vector, as $\sin^2\phi + \cos^2\phi = 1$. This means that our scale factor $h_{\rho} = 1$, and our unit basis vector is given by,

\begin{align*}
  \mathbf{e_{\rho}} =
  \begin{pmatrix}
    \cos\phi \\
    \sin\phi \\
    0
  \end{pmatrix}
\end{align*}

Similarly, for the $\phi$ and $z$ coordinates,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial\phi} = \rho
  \begin{pmatrix}
    -\sin\phi \\
    \cos\phi \\
    0
  \end{pmatrix}
\end{align*}

This time we see that the result is not a unit vector, but by factoring out $\rho$, we get the scale factor multiplied by a unit basis vector, therefore we have,

\begin{align*}
  h_{\phi} = \rho
\end{align*}

and

\begin{align*}
  \mathbf{e_{\phi}} =
  \begin{pmatrix}
    -\sin\phi \\
    \cos\phi \\
    0
  \end{pmatrix}
\end{align*}

Finally we have the $z$ coordinate,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial z} =
  \begin{pmatrix}
    0 \\
    0 \\
    1
  \end{pmatrix} \to
  \mathbf{e_z} =
  \begin{pmatrix}
    0 \\
    0 \\
    1
  \end{pmatrix}
\end{align*}

Here the scale factor again is just $h_z = 1$.

Next we need to check whether these unit basis form an orthogonal coordinate system,

\begin{alignat*}{2}
  \mathbf{e_{\rho}}\cdot\mathbf{e_{\phi}}&=
  \begin{pmatrix}
    \cos\phi \\
    \sin\phi \\
    0
  \end{pmatrix}\cdot
  \begin{pmatrix}
    -\sin\phi \\
    \cos\phi \\
    0
  \end{pmatrix} &&= 0 \\
  \mathbf{e_{\rho}}\cdot\mathbf{e_z}&=
  \begin{pmatrix}
    \cos\phi \\
    \sin\phi \\
    0
  \end{pmatrix}\cdot
  \begin{pmatrix}
    0 \\
    0 \\
    1
  \end{pmatrix} &&= 0 \\
  \mathbf{e_{\phi}}\cdot\mathbf{e_z}&=
  \begin{pmatrix}
    -\sin\phi \\
    \cos\phi \\
    0
  \end{pmatrix}\cdot
  \begin{pmatrix}
    0 \\
    0 \\
    1
  \end{pmatrix} &&= 0
\end{alignat*}

Therefore we have that all the unit basis vectors are mutually orthogonal. Also to check that the order of the coordinates $(\rho, \phi, z)$ we calculate the cross product and see that $\mathbf{e_{\rho}}\times\mathbf{e_{\phi}}=\mathbf{e_z}$ although this will not be shown explicitly here as it is simply the cross product of two vectors.

\section{Spherical Polar Coordinates}

Again we will take the same approach as last time. This time we know we can write $(x, y, z)$ as $(r, \theta, \phi)$ by the relations,

\begin{align*}
  \mathbf{r} =
  \begin{pmatrix}
    r\sin\theta\cos\phi \\
    r\sin\theta\sin\phi \\
    r\cos\theta
  \end{pmatrix}
\end{align*}

So we first take the derivative of the position vector with respect to each coordinate to find the vectors in the direction of each increasing coordinate,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial r} =
  \begin{pmatrix}
    \sin\theta\cos\phi \\
    \sin\theta\sin\phi \\
    \cos\theta
  \end{pmatrix}
\end{align*}

By $\sin^2\phi + \cos^2\phi = 1$ this again is already a unit vector, so $h_r = 1$ and,

\begin{align*}
  \mathbf{e_r} =
  \begin{pmatrix}
    \sin\theta\cos\phi \\
    \sin\theta\sin\phi \\
    \cos\theta
  \end{pmatrix}
\end{align*}

and for the $\theta$ and $\phi$ coordinates,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial\theta} = r
  \begin{pmatrix}
    \cos\theta\cos\phi \\
    \cos\theta\sin\phi \\
    -\sin\theta
  \end{pmatrix}
\end{align*}

The scale factor is $h_{\theta} = r$ and,

\begin{align*}
  \mathbf{e_{\theta}} =
  \begin{pmatrix}
    \cos\theta\cos\phi \\
    \cos\theta\sin\phi \\
    -\sin\theta
  \end{pmatrix}
\end{align*}

For the last coordinate $\phi$,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial\phi} = r\sin\theta
  \begin{pmatrix}
    \cos\theta\cos\phi \\
    \cos\theta\sin\phi \\
    -\sin\theta
  \end{pmatrix}
\end{align*}

Therefore this time we have a scale factor of $h_{\phi} = r\sin\theta$ and,

\begin{align*}
  \mathbf{e_{\phi}} =
  \begin{pmatrix}
    -\sin\phi \\
    \cos\phi \\
    0
  \end{pmatrix}
\end{align*}

Again we check for orthogonality,

\begin{align*}
  \mathbf{e_r}\cdot\mathbf{e_{\theta}} &= 0 \\
  \mathbf{e_r}\cdot\mathbf{e_{\phi}} &= 0 \\
  \mathbf{e_{\phi}}\cdot\mathbf{e_{\theta}} &= 0
\end{align*}

And finally we check that $(r, \theta, \phi)$ is the correct order of the coordinates,

\begin{align*}
  \mathbf{e_r}\times\mathbf{e_{\theta}}=\mathbf{e_{\phi}}
\end{align*}

\section{Paraboidal Coordinates}

The paraboidal coordinate $(u, v, \phi)$ are related to the cartesian coordinates such that,

\begin{align*}
  \mathbf{r}=
  \begin{pmatrix}
    uv\cos\phi \\
    uv\sin\phi \\
    \frac{1}{2}\left(u_2 - v^2\right)
  \end{pmatrix}
\end{align*}

Again we take the derivatives,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial u} =
  \begin{pmatrix}
    v\cos\phi \\
    v\sin\phi \\
    u
  \end{pmatrix}
\end{align*}

This time, unlike before, finding the scale factor and thus the unit basis vector is not as easy as a simple factorisation to construct the unit vector. This time we must find the modulus of the derivative to give us the scale factor,

\begin{align*}
  h_u = \left|\frac{\partial\mathbf{r}}{\partial u}\right| = \sqrt{u_2 + v_2}
\end{align*}

so our unit vector is given by,

\begin{align*}
  \mathbf{e_u} = \frac{1}{\sqrt{u^2 + v^2}}
  \begin{pmatrix}
    v\cos\phi \\
    v\sin\phi \\
    u
  \end{pmatrix}
\end{align*}

and for coordinate $v$ we find,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial v} =
  \begin{pmatrix}
    u\cos\phi \\
    u\sin\phi \\
    -v
  \end{pmatrix}
\end{align*}

so just as before $h_v = \sqrt{u^2 + v^2}$ and,

\begin{align*}
  \mathbf{e_v} =
  \begin{pmatrix}
    u\cos\phi \\
    u\sin\phi \\
    -v
  \end{pmatrix}
\end{align*}

and for coordinate $\phi$,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial\rho} =
  \begin{pmatrix}
    -uv\sin\phi \\
    uv\cos\phi \\
    0
  \end{pmatrix}
\end{align*}

This time we can factorize so that $h_{\phi} = uv$ and,

\begin{align*}
  \mathbf{e_{\phi}} =
  \begin{pmatrix}
    -\sin\phi \\
    \cos\phi \\
    0
  \end{pmatrix}
\end{align*}

This time, to check for orthogonality, we will take the dot product of the derivatives of the unit vectors instead of the unit vectors themselves. We do this as a convenience to make the calculation easier. It is possible to do this because the derivative $\partial \mathbf{r} / \partial u_1$ is just the unit vector $\mathbf{e_1}$ multiplied by a constant, the scale factor. By computing the dot products we see that,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial u}\cdot\frac{\partial\mathbf{r}}{\partial v} &= 0 \\
  \frac{\partial\mathbf{r}}{\partial u}\cdot\frac{\partial\mathbf{r}}{\partial \phi} &= 0 \\
  \frac{\partial\mathbf{r}}{\partial v}\cdot\frac{\partial\mathbf{r}}{\partial \phi} &= 0
\end{align*}

and therefore,

\begin{align*}
  \mathbf{e_u}\cdot\mathbf{e_v} &= 0 \\
  \mathbf{e_u}\cdot\mathbf{e_{\phi}} &= 0 \\
  \mathbf{e_v}\cdot\mathbf{e_{\phi}} &= 0
\end{align*}

Therefore we have an orthogonal basis. The order of the coordinates is checked just as before and we find that $(u, v, \phi)$ is indeed the correct order, such that,

\begin{align*}
  \mathbf{e_u}\times\mathbf{e_v}=\mathbf{e_{\phi}}
\end{align*}

\section{The Gradient}

In this section we will discover how to take the gradient of a scalar function in an orthogonal coordinate system. First we note that the gradient will be a vector function acting on a scalar field $\Psi$ such that,

\begin{align*}
  \nabla\Psi = A_1 \mathbf{e_1} + A_2 \mathbf{e_2} + A_3 \mathbf{e_3}
\end{align*}

The difficulty arises since in an orthogonal coordinate system $\mathbf{e_1}$, $\mathbf{e_2}$, and $\mathbf{e_3}$ can vary in space, unlike the Cartesian coordinate system where $\hat{\imath}$, $\hat{\jmath}$, and $\hat{k}$ are constant.

The coefficients, $A_i$ can be extracted by using the orthogonality of the vectors $\mathbf{e_i}$. This allows us to use the dot product to extract each component of the gradient,

\begin{align*}
  A_i = \mathbf{e_i} \cdot \nabla\Psi = \frac{1}{h_i} \frac{\partial\mathbf{r}}{\partial u_i} \cdot \nabla\Psi
\end{align*}

Here we have used the discovery from the last section that the derivative in some direction $\partial\mathbf{r}/\partial u_i$ is just the unit vector $\mathbf{e_i}$ multiplied by some scale factor $h_i$. Expanding out this scalar product gives,

\begin{align*}
  \frac{\partial\mathbf{r}}{\partial u_i} &= \left(\frac{\partial x}{\partial u_i}, \frac{\partial y}{\partial u_i}, \frac{\partial z}{\partial u_i}\right) \cdot \left(\frac{\partial\Psi}{\partial x}, \frac{\partial\Psi}{\partial y}, \frac{\partial\Psi}{\partial z}\right) \\
                                          &= \frac{\partial\Psi}{\partial x} \frac{\partial x}{\partial u_i} + \frac{\partial\Psi}{\partial y} \frac{\partial y}{\partial u_i} + \frac{\partial\Psi}{\partial z} \frac{\partial z}{\partial u_i} \\
                                          &= \frac{\partial\Psi}{\partial u_i}
\end{align*}

In the last step we have just applied the chain rule in reverse, that is, that the derivative of $\Psi$ with respect to $u_i$ can be expressed as the derivatives of each Cartesian component. If you apply the chain rule to the final line it can be seen that this is what results. We now have an expression for an arbitrary coefficient $A_i$ of the gradient,

\begin{align*}
  A_i = \frac{1}{h_i} \frac{\partial\Psi}{\partial u_i}
\end{align*}

Therefore, by substituting these coefficients into our equation for the gradient,

\begin{align*}
  \nabla\Psi = \frac{1}{h_1}\frac{\partial\Psi}{\partial u_1} \mathbf{e_1} + \frac{1}{h_2}\frac{\partial\Psi}{\partial u_2} \mathbf{e_2} + \frac{1}{h_3}\frac{\partial\Psi}{\partial u_3} \mathbf{e_3}
\end{align*}

For example, in spherical polar coordinates this would be,

\begin{align*}
  \nabla\Psi = \frac{\partial\Psi}{\partial r} \mathbf{e_r} + \frac{1}{r}\frac{\partial\Psi}{\partial\theta}\mathbf{e_{\theta}} + \frac{1}{r\sin\theta}\frac{\partial\Psi}{\partial\Phi}\mathbf{e_{\Phi}}
\end{align*}

We now have an expression for the differential operator $\nabla$ in any orthogonal coordinate system,

\begin{align*}
  \nabla = \frac{\mathbf{e_1}}{h_1}\frac{\partial}{\partial u_1} + \frac{\mathbf{e_2}}{h_2}\frac{\partial}{\partial u_2} + \frac{\mathbf{e_3}}{h_3}\frac{\partial}{\partial u_3}
\end{align*}

When we evaluate $\nabla\cdot\mathbf{A}$ or $\nabla\times\mathbf{A}$, the derivative operators also apply to the unit vectors $\mathbf{e_i}$. This was fine in Cartesian coordinates because the unit vectors did not change in space, but now we have unit vectors which vary in the $x$, $y$, and $z$ directions. Therefore if we want to calculate the divergence or the curl we have to take a lot of derivatives, but this isn't necessary and it turns out that it is easier to apply Gauss' theorem and Stoke's theorem instead.

\section{Divergence in Orthogonal Coordinates}

Consider an infinitesimal cuboid situated at $(u_1, u_2, u_3)$ with sides of length $h_1 du_1$, $h_2 du_2$, and $h3 du_3$. We want to calculate the surface integral over the surface of the cuboid,

\begin{align*}
  \oint_S \mathbf{A}\cdot d\mathbf{S}
\end{align*}

Our vector field $\mathbf{A}$ will be of the form,

\begin{align*}
  \mathbf{A} = A_1 \mathbf{e_1} + A_2 \mathbf{e_2} + A_3 \mathbf{e_3}
\end{align*}

First we will consider the flux through the surfaces parallel to $\mathbf{e_1}$,

\begin{align*}
  \int_{S_1} \mathbf{A}\cdot d\mathbf{S_1} &= \mathbf{A}\cdot d\mathbf{S_1} = \mathbf{A}\cdot h_2 du_2 h_2 du_3 \mathbf{e_1} = h_2 h_3 A_1 du_2 du_3 \\
  \int_{S_2} \mathbf{A}\cdot d\mathbf{S_2} &= \mathbf{A}\cdot d\mathbf{S_2} = -\mathbf{A}\cdot h_2 du_2 h_2 du_3 \mathbf{e_1} = -h_2 h_3 A_1 du_2 du_3
\end{align*}

The minus sign appears because $\mathbf{S_2}$ is in the opposite direction to $\mathbf{S_1}$. It may seem almost like when we sum them, they will disappear, but we have to remember that these coefficients will vary in different places in space; the $A_1$ in the first integral is evaluated at $(u_1 + du_1, u_2, u_3)$ whereas the $A_1$ in the second integral is evaluated at $(u_1, u_2, u_3)$. Now by summing these integrals,

\begin{align*}
  \int_{S_1 + S_2} \mathbf{A}\cdot d\mathbf{S} &= \left[h_2 h_3 A_1(u_1 + du_1) - h_2 h_3 A_1(u_1)\right] du_2 du_3 \\
                                               &= \left[\frac{\partial}{\partial u_1} (h_2 h_3 A_1) du_1\right] du_2 du_3
\end{align*}

In this last line we have used the definition of the derivative to see that the term in square brackets in the first line is just the derivative $\partial \dots / \partial u1$ multiplied by $du_1$.

When we sum all of the other pairs of surfaces we get similar results,

\begin{align*}
  \oint_S \mathbf{A}\cdot d\mathbf{S} = \left[\frac{\partial}{\partial u_1}(h_2h_3A_1) + \frac{\partial}{\partial u_2}(h_3h_1A_2) + \frac{\partial}{\partial u_3}(h_1h_2A_3)\right] du_1 du_2 du_3
\end{align*}

Gauss' theorem tells us that the divergence is just the flux per unit volume, so we define the volume of the cuboid as,

\begin{align*}
  \Delta V = h_1h_2h_3du_1du_2du_3
\end{align*}

and then by using that divergence is the flux divided by volume,

\begin{align*}
  \nabla\cdot\mathbf{A} = \frac{\oint_S \mathbf{A}\cdot d\mathbf{S}}{\Delta V} = \frac{1}{h_1h_2h_3} \left[\frac{\partial}{\partial u_1}(h_2h_3A_1) + \frac{\partial}{\partial u_2}(h_3h_1A_2) + \frac{\partial}{\partial u_3}(h_1h_2A_3)\right]
\end{align*}

Similarly this allows us to find an expression for the Laplacian of a scalar field, $\nabla^2 \Psi = \nabla \cdot (\nabla \Psi)$,

\begin{align*}
  \nabla\Psi = \frac{1}{h_1}\frac{\partial\Psi}{\partial u_1} \mathbf{e_1} + \frac{1}{h_2}\frac{\partial\Psi}{\partial u_2} \mathbf{e_2} + \frac{1}{h_3}\frac{\partial\Psi}{\partial u_3} \mathbf{e_3}
\end{align*}

and then substituting this into the divergence,

\begin{align*}
  \nabla^2\Psi = \frac{1}{h_1h_2h_3}\left[\frac{\partial}{\partial u_1}\left(\frac{h_2h_3}{h_1}\frac{\partial\Psi}{\partial u_1}\right) + \frac{\partial}{\partial u_2}\left(\frac{h_3h_1}{h_2}\frac{\partial\Psi}{\partial u_2}\right) + \frac{\partial}{\partial u_3}\left(\frac{h_1h_2}{h_3}\frac{\partial\Psi}{\partial u_3}\right)\right]
\end{align*}


\end{document}
